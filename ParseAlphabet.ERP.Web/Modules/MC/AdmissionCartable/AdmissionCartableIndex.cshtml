@{
    ViewBag.Title = "کارتابل خدمات";
}
<link href="~/lib/ModulesCss/AdmissionCartable.css" rel="stylesheet"/>
<link href="~/lib/ModalePrint/PrintCss.css" rel="stylesheet"/>

<script src="~/js/formplate.js"></script>
<script src="~/js/formplate1.js"></script>
<script src="~/js/NewPagetable.js"></script>

<div class="content-page displaynone" id="content-page">
    <div class="content">
        <div class="container-fluid">
            <div class="card">
                <div class="header-title d-flex">
                    <div id="bcTarget" style="display : none"></div>
                    <span>@ViewBag.Title</span>
                    <div class="inboundTimer float-left">
                        <button type="button" onclick="listOfClientByStatus()" class="btn btn-success waves-effect ml-1">لیست مراجعین به تفکیک گام</button>
                        <button type="button" onclick="showModalChangeReserveDate()" class="btn btn-success waves-effect ml-2">جابه جایی نوبت رزرو</button>
                        <div id="admissionAttenderScheduleContainer"></div>
                        <button class="btn btn-success waves-effect" type="button" id="resetList">بازنشانی</button>
                        <div class="timerBtn border-right pr-2">
                            <button class="btn btn-info" type="button" id="refreshlist">
                                <i class="fa fa-sync-alt"></i>
                            </button>
                            <button class="btn btn-success" type="button" id="stopTimerInterval">
                                <i class="fa fa-play"></i>
                            </button>
                        </div>
                        <div class="timerBox text-center">
                            <div class="font-18" id="timerBox">00:30</div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-12">
                    <div class="card m-b-30">
                        <div class="card-body">
                            <fieldset id="filterInputBox" class="group-box group-box-gray" data-parsley-validate>
                                <legend>فیلتر</legend>
                                <div class="row">
                                    <div class="col-md-3 form-group ml-0 mb-0">
                                        <label>داکتر</label>
                                        <div class="col-12 chosen-container-parent">
                                            <select class="select2" id="attenderId" tabindex="1" required data-parsley-errors-container="#attenderIdErrorContainer">
                                            </select>
                                        </div>
                                        <div id="attenderIdErrorContainer"></div>
                                    </div>
                                    <div class="form-group col-md-3">
                                        <label>تاریخ روز کاری</label>
                                        <div class="double-input-box">
                                            <div class="double-input">
                                                <input id="fromWorkDayDatePersian" type="text" class="form-control persian-date" placeholder="تاریخ را وارد نمایید" data-inputmask="'mask':'9999/99/99'"
                                                       data-parsley-shamsidate
                                                       data-parsley-compareshamsidateyear="toWorkDayDatePersian"
                                                       data-parsley-comparedate="toWorkDayDatePersian"
                                                       data-parsley-dateisonemonth="toWorkDayDatePersian"
                                                       data-parsley-errors-container="#fromWorkDayDatePersianContainer"
                                                       maxlength="10" tabindex="2"/>
                                            </div>
                                            <div class="double-input">
                                                <input id="toWorkDayDatePersian" type="text" class="form-control persian-date" placeholder="تاریخ را وارد نمایید" data-inputmask="'mask':'9999/99/99'"
                                                       data-parsley-shamsidate
                                                       data-parsley-errors-container="#toWorkDayDatePersianContainer"
                                                       maxlength="10" tabindex="3"/>
                                            </div>
                                        </div>
                                        <div class="double-input-box">
                                            <div class="double-input" id="fromWorkDayDatePersianContainer"></div>
                                            <div class="double-input" id="toWorkDayDatePersianContainer"></div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label style="visibility:hidden">جدول زمان بندی</label>
                                        <div class="form-group">
                                            <button type="button" id="scheduleInfo" tabindex="" class="btn btn-secondary pt-0 m-t-1" style="font-size:12px;height:30px">
                                                <i class="fa fa-bars" aria-hidden="true" style="padding-top:3px"></i>
                                            </button>
                                        </div>
                                    </div>
                                    <div class="form-group col-md-2 ml-0 mb-0">
                                        <label>تسویه شده/نشده</label>
                                        <div>
                                            <select id="isSettled" class="form-control select2" title="" tabindex="5">
                                                <option value="-1">انتخاب کنید</option>
                                                <option value="0">تسویه نشده</option>
                                                <option value="1">تسویه شده</option>

                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <button type="button" id="expandAdmissionBtn" onclick="expandAdmission(this)" class="btn btn-light border-orange plus">
                                    <i class="fas fa-plus"></i>
                                </button>
                                <div class="slideToggle get" style="display:none;">
                                    <div class="row">
                                        <div class="form-group col-sm-3">
                                            <label>شعبه</label>
                                            <select id="branchId" class="form-control select2" tabindex="6"></select>
                                        </div>
                                        <div class="form-group col-sm-3">
                                            <label>گردش کار</label>
                                            <div class="col-12 chosen-container-parent">
                                                <select data-placeholder="انتخاب کنید" id="workflowId" class="select2 select2-quick-access" tabindex="7">
                                                    <option></option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="form-group col-sm-3">
                                            <label>مرحله</label>
                                            <div class="col-12 chosen-container-parent">
                                                <select data-placeholder="انتخاب کنید" id="stageId" class="select2 select2-quick-access" tabindex="8">
                                                    <option></option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="form-group col-md-1">
                                            <label>شناسه پرونده</label>
                                            <input id="admissionsMasterId" type="text" class="form-control number" tabindex="9"/>
                                        </div>
                                        <div class="form-group col-md-1">
                                            <label>شناسه پذیرش</label>
                                            <input id="id" type="text" class="form-control number" tabindex="10"/>
                                        </div>
                                        <div class="form-group col-sm-3">
                                            <label>مراجعه کننده</label>
                                            <div class="col-12 chosen-container-parent">
                                                <select data-placeholder="انتخاب کنید" id="patientId" class="select2 select2-quick-access" tabindex="11">
                                                    <option></option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="form-group col-md-3">
                                            <label>خدمت</label>
                                            <select class="form-control select2" id="serviceId" tabindex="12" disabled>
                                            </select>
                                        </div>
                                        <div class="form-group col-md-2">
                                            <label style="visibility:hidden">جستجو</label>
                                            <div class="form-group">
                                                <button class="btn btn-success" type="button" tabindex="13" id="refreshPagetable" style="padding:4px">جستجو</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </fieldset>
                            <ul id="tabActionBox" class="nav nav-pills nav-justified" role="tablist"></ul>
                            <div id="tabBoxByAction" class="tab-content group-box group-box-gray w-100 d-none"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="reserveModal" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true" onkeydown="modal_onkeydown(event, this)">
    <div class="modal-dialog pt-0 modal-size-xl">
        <div class="modal-content">
            @await Html.PartialAsync("/Modules/MC/Admission/GetAttenderReserve.cshtml")
        </div>
    </div>
</div>

<div id="PrnAdmission" class="modal fade" tabindex="-1" data-keyboard="false" role="dialog" aria-labelledby="modal_title" aria-hidden="true" onkeydown="modal_onkeydown(event, this)">
    <div class="modal-dialog modal-size-xs">
        <div class="modal-content">
            <div class="modal-header bg-header">
                <div class="text-right">
                    <h5 class="modal-title mt-2" id="modal_title">چاپ</h5>
                </div>
            </div>
            <div class="modal-body modal-max-height text-right" data-parsley-validate style="padding:0;">
                <div class="PrnModalId" id="rowKeyId">
                    <div class="d-block w-100 text-right mb-2 pr-3">
                        <div class="key_id">
                            <lable id="modal_keyid_caption">شناسه : </lable> <span id="modal_keyid_value">0</span>
                        </div>
                    </div>
                </div>
                <div class="card-body" style="padding:0;">
                    <div class="input-group col-12 PrnModalDiv">
                        <i class="fa fa-print fa-modal-print"></i>
                        <a id="PrntType1" onclick="separationprint()" class="btn btn-default" style="font-weight:bolder;">چاپ تفکیک<sub class="text-gray mr-2 font-11 color-navy">( Ctrl + 1 )</sub></a>
                    </div>
                    <div class="input-group col-12 PrnModalDiv">
                        <i class="fa fa-print fa-modal-print"></i>
                        <a id="PrntType2" onclick="aggregationprint()" class="btn btn-default" style="font-weight:bolder;">چاپ تجمیع<sub class="text-gray mr-2 font-11 color-navy">( Ctrl + 2 )</sub></a>
                    </div>
                    <div class="input-group col-12 PrnModalDiv">
                        <i class="fa fa-print fa-modal-print"></i>
                        <a id="PrntType3" onclick="doubleprint(this)" class="btn btn-default" style="font-weight:bolder;">چاپ دو نسخه ای<sub class="text-gray mr-2 font-11 color-navy">( Ctrl + 3 )</sub></a>
                    </div>
                </div>
            </div>
            <div class="modal-footer" style="border:0;">
                <button id="modal-close" onclick="modal_close('PrnAdmission')" class="btn btn-secondary waves-effect" title="Esc"><i class="fa fa-times-circle"></i>انصراف</button>
            </div>
        </div>
    </div>
</div>

<div id="actionModal" class="modal fade" tabindex="-1" data-keyboard="false" role="dialog" aria-labelledby="modal_title" aria-hidden="true" onkeydown="modal_onkeydown(event, this)">
    <div class="modal-dialog modal-size-xlg">
        <div class="modal-content">
            <div class="modal-header bg-header">
                <div class="text-right">
                    <h5 class="modal-title mt-2" id="modal_title">انتخاب گام</h5>
                </div>
            </div>
            <div class="modal-body modal-max-height-lg text-right" data-parsley-validate style="padding:0;">
                <div class="card-body" style="padding:0;">
                    <div class="row">
                        <div class="col-12">
                            <div style="overflow-y:scroll !important;overflow-x:auto!important;padding:5px" id="tableLine">
                                <table style="width:100% !important">
                                    <thead>
                                    <tr>
                                        <th style="width:4%">سطر</th>
                                        <th style="width:10%">شناسه پذیرش</th>
                                        <th style="width:25%">جریان کار</th>
                                        <th style="width:25%">مرحله</th>
                                        <th style="width:36%">عملیات</th>
                                    </tr>
                                    </thead>
                                    <tbody id="actionModalTable">
                                    <tr>
                                        <td colspan="5" style="text-align:center">سطری وجود ندارد</td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer" style="border:0;">
                <button id="modal-close" onclick="modal_close('actionModal')" class="btn btn-secondary waves-effect" title="Esc"><i class="fa fa-times-circle"></i>انصراف</button>
            </div>
        </div>
    </div>
</div>

<div id="actionsModal" class="modal fade" tabindex="-1" data-keyboard="false" role="dialog" aria-labelledby="modal_title" aria-hidden="true" onkeydown="modal_onkeydown(event, this)">
    <div class="modal-dialog modal-size-xlg">
        <div class="modal-content">
            <div class="modal-header bg-header">
                <div class="text-right">
                    <h5 class="modal-title mt-2" id="modal_title">انتخاب گام</h5>
                </div>
            </div>
            <div class="modal-body modal-max-height-lg text-right" data-parsley-validate style="padding:0;">
                <div class="card-body" style="padding:0;">
                    <div class="row">
                        <div class="col-12">
                            <div style="overflow-y:scroll !important;overflow-x:auto!important;padding:5px" id="tableLine">
                                <table style="width:100% !important">
                                    <thead>
                                    <tr>
                                        <th style="width:4%">سطر</th>
                                        <th style="width:25%">جریان کار</th>
                                        <th style="width:25%">مرحله</th>
                                        <th style="width:6%">تعداد پذیرش</th>
                                        <th style="width:40%">گام</th>
                                    </tr>
                                    </thead>
                                    <tbody id="actionsModalTable">
                                    <tr>
                                        <td colspan="5" style="text-align:center">سطری وجود ندارد</td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer" style="border:0;">
                <button id="modal_saveActions" onclick="modal_saveActions('actionsModal',this);" class="btn btn-success waves-effect waves-light" title="Ctrl + S"><i class="fa fa-check-circle"></i>ذخیره</button>
                <button id="modal-close" onclick="modal_close('actionsModal')" class="btn btn-secondary waves-effect" title="Esc"><i class="fa fa-times-circle"></i>انصراف</button>
            </div>
        </div>
    </div>
</div>

<div id="listOfClientByStatusModal" class="modal fade" tabindex="-1" data-keyboard="false" role="dialog" aria-labelledby="modal_title" aria-hidden="true" onkeydown="modal_onkeydown(event, this)">
    <div class="modal-dialog modal-size-xxlg">
        <div class="modal-content">
            <div class="modal-header bg-header">
                <div class="text-right">
                    <h5 class="modal-title mt-2" id="modal_title">لیست مراجعین به تفکیک گام</h5>
                </div>
            </div>
            <div class="modal-body modal-max-height text-right pr-2 pl-2" data-parsley-validate style="padding:0;">
                <div id="receptionTabs" class="w-100 mt-4 mb-4">
                    <ul id="receptionListsTab" class="nav nav-pills nav-justified" role="tablist">
                    </ul>
                    <div id="receptionListContent" class="tab-content group-box group-box-gray" style="display:none;overflow-x: auto">
                    </div>
                </div>
            </div>
            <div class="modal-footer" style="border:0;">
                <button id="modal-close" onclick="modal_close('listOfClientByStatusModal')" class="btn btn-secondary waves-effect" title="Esc"><i class="fa fa-times-circle"></i>انصراف</button>
            </div>
        </div>
    </div>
</div>

<div id="actionErrModal" class="modal fade" tabindex="-1" data-keyboard="false" role="dialog" aria-labelledby="modal_title" aria-hidden="true" onkeydown="modal_onkeydown(event, this)">
    <div class="modal-dialog modal-size-xlg">
        <div class="modal-content">
            <div class="modal-header bg-header">
                <div class="text-right">
                    <h5 class="modal-title mt-2" id="modal_title">سطر های خطادار</h5>
                </div>
            </div>
            <div class="modal-body modal-max-height-lg text-right" data-parsley-validate style="padding:0;">
                <div class="card-body" style="padding:0;">
                    <div class="row">
                        <div class="col-12">
                            <div style="overflow-y:scroll !important;overflow-x:auto!important;padding:5px" id="tableLine">
                                <table style="width:100% !important">
                                    <thead>
                                    <tr>
                                        <th style="width:5%">سطر</th>
                                        <th style="width:95%">شناسه پذیرش / خطا</th>

                                    </tr>
                                    </thead>
                                    <tbody id="actionErrTable">
                                    <tr>
                                        <td colspan="2" style="text-align:center">سطری وجود ندارد</td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer" style="border:0;">
                <button id="modal-close" onclick="modal_close('actionErrModal')" class="btn btn-secondary waves-effect" title="Esc"><i class="fa fa-times-circle"></i>انصراف</button>
            </div>
        </div>
    </div>
</div>

@await Html.PartialAsync("/Modules/MC/AdmissionMaster/AdmissionMasterDisplay.cshtml")

<div id="displacementReserveDateModal" class="modal fade" data-keyboard="false" tabindex="-1" role="dialog" aria-labelledby="modal_title" aria-hidden="true" onkeydown="modal_onkeydown(event, this)">
    <div class="modal-dialog modal-size-xxxlg">
        <div class="modal-content">
            <div class="modal-header bg-header">
                <div class="col-lg-6 text-right">
                    <h5 class="modal-title mt-0" id="modal_title">جابجایی نوبت رزرو </h5>
                </div>
            </div>
            <div class="modal-body  text-right " data-parsley-validate style="padding:0;">
                <div class="card-body" id="attenderScheduleBlockOperation">
                    <ul class="nav nav-pills nav-justified" role="tablist" id="attenderScheduleBlockUI">
                        <li class="nav-item waves-effect waves-light" onclick="focusInput(1)">
                            <a class="nav-link active" data-toggle="tab" href="#attenderScheduleBlockReplace" role="tab" id="attenderScheduleBlockReplaceTab">
                                <span class="d-none d-md-block">جابه جایی نوبت مراجعه کننده در یک شعبه</span>
                                <span class="d-block d-md-none">
                                    <i class="mdi mdi-home-variant h5"></i>
                                </span>
                            </a>
                        </li>
                        <li class="nav-item waves-effect waves-light" onclick="focusInput(2)">
                            <a class="nav-link" data-toggle="tab" href="#attenderScheduleBlockMove" role="tab" id="attenderScheduleBlockMoveTab">
                                <span class="d-none d-md-block"> انتقال گروهی نوبت مراجعین </span>
                                <span class="d-block d-md-none">
                                    <i class="mdi mdi-home-variant h5"></i>
                                </span>
                            </a>
                        </li>

                    </ul>
                    <div class="tab-content group-box group-box-gray">
                        <div class="tab-pane active p-3" id="attenderScheduleBlockReplace" role="tabpanel">
                            <div class="row form-group tabToggle1">
                                @await Html.PartialAsync("/Modules/MC/AttenderScheduleBlockOperation/AttenderScheduleBlockReplace.cshtml")
                            </div>
                        </div>
                        <div class="tab-pane p-3" id="attenderScheduleBlockMove" role="tabpanel">
                            <div class="row form-group tabToggle2">
                                @await Html.PartialAsync("/Modules/MC/AttenderScheduleBlockOperation/AttenderScheduleBlockMove.cshtml")
                            </div>
                        </div>

                    </div>


                </div>
            </div>
            <div class="modal-footer" style="border:0;">
                <button id="modal-close" onclick="modal_close('displacementReserveDateModal')" class="btn btn-secondary waves-effect" title="Esc"><i class="fa fa-times-circle"></i>انصراف</button>

            </div>
        </div>
    </div>
</div>


<script src="~/plugins/barcode/jquery-barcode.min.js"></script>
<script src="~/js/formplate.js"></script>
<script src="~/js/formplate1.js"></script>
<script src="~/js/admission.js?ver=@Guid.NewGuid().ToString().Replace("-", "")"></script>
<script src="~/lib/jquery-ui/js/jquery-ui.js" type="text/javascript"></script>
<script src="~/Modules/MC/AdmissionCartable/AdmissionCartableIndex.js?ver=@Guid.NewGuid().ToString().Replace("-", "")"></script>
<script src="/Modules/MC/Attender/AdmissionAttenderSchedulePage.js?ver=@Guid.NewGuid().ToString().Replace("-", "")"></script>